import{x as _,r as u,j as e,m as q,ag as G,ah as D,ai as K,a6 as V,Z as Y,C as he,B as J,aj as ge,ak as fe,a4 as me,al as be,am as ye,y as Z,an as je,ao as ve,h as Se,ap as Ce,aq as we,ar as ze,as as ke,at as Le,au as $e,R as Re,av as Me,w as Te,K as Ie,I as P,H as C,aw as Ee,V as Oe}from"./index-B7WG_kHJ-1769026461592.js";import{a as Pe,b as We,L as He}from"./Layout-BnB1agDJ-1769026461592.js";import{B as T}from"./Button-BLF6EOYE-1769026461592.js";import{M as A}from"./Modal-BJmk3CCX-1769026461592.js";import{I as W}from"./Input-Bz5_UG-L-1769026461592.js";import{A as De}from"./index-yirOBEcN-1769026461592.js";import{m as y}from"./motion-DSM7Rpg2-1769026461592.js";import{u as Ae}from"./useThemeColors-DHOyp60z-1769026461592.js";const Ne={bgCardLit:"linear-gradient(165deg, #2a2722 0%, #1e1c18 50%, #1a1816 100%)",textPrimary:"#ffffff",textMuted:"rgba(255, 255, 255, 0.5)",cardShadowLit:"0 8px 32px rgba(0, 0, 0, 0.5), 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255,255,255,0.06)",error:"#ef4444"},X=l=>{const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(l);return a?`${parseInt(a[1],16)}, ${parseInt(a[2],16)}, ${parseInt(a[3],16)}`:"106, 212, 160"},_e=({children:l,items:a,disabled:g=!1})=>{const{colors:x}=_(),[w,f]=u.useState(!1),p=u.useMemo(()=>({...Ne,accent:x.accent,accentLight:x.accentLight,border:`rgba(${X(x.accent)}, 0.15)`,borderHover:`rgba(${X(x.accent)}, 0.35)`}),[x]),[i,k]=u.useState({x:0,y:0}),z=u.useRef(null),L=u.useRef(null),j=u.useRef(null),v=u.useRef(null);u.useEffect(()=>{const s=r=>{L.current&&!L.current.contains(r.target)&&f(!1)},m=()=>{f(!1)};return w&&(document.addEventListener("mousedown",s),document.addEventListener("touchstart",s,{passive:!0}),window.addEventListener("scroll",m,!0)),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s),window.removeEventListener("scroll",m,!0)}},[w]);const M=u.useCallback((s,m)=>{const b=a.length*44+16,c=8,$=88;let O=s,n=m;return s+180>window.innerWidth-c&&(O=window.innerWidth-180-c),m+b>window.innerHeight-$&&(n=window.innerHeight-b-$),O<c&&(O=c),n<c&&(n=c),{x:O,y:n}},[a.length]),R=s=>{if(g)return;s.preventDefault(),s.stopPropagation();const m=M(s.clientX,s.clientY);k(m),f(!0)},h=s=>{if(g)return;const m=s.touches[0];v.current={x:m.clientX,y:m.clientY},j.current=setTimeout(()=>{if(v.current){navigator.vibrate&&navigator.vibrate(50);const r=M(v.current.x,v.current.y);k(r),f(!0)}},500)},I=s=>{if(j.current&&v.current){const m=s.touches[0],r=Math.abs(m.clientX-v.current.x),b=Math.abs(m.clientY-v.current.y);(r>10||b>10)&&(clearTimeout(j.current),j.current=null)}},H=()=>{j.current&&(clearTimeout(j.current),j.current=null)},E=s=>{s.disabled||(f(!1),s.onClick())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:z,onContextMenu:R,onTouchStart:h,onTouchMove:I,onTouchEnd:H,style:{userSelect:"none"},children:l}),e.jsx(De,{children:w&&e.jsx(e.Fragment,{children:e.jsxs(y.div,{ref:L,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},style:{position:"fixed",left:i.x,top:i.y,zIndex:101,minWidth:"180px",padding:"8px 0",background:p.bgCardLit,border:`1px solid ${p.border}`,borderRadius:"16px",boxShadow:p.cardShadowLit,overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:"25%",right:"25%",height:"1px",background:`linear-gradient(90deg, transparent, ${p.accentLight}4D, transparent)`}}),a.map((s,m)=>{const r=s.icon;return e.jsxs(y.button,{onClick:()=>E(s),disabled:s.disabled,style:{width:"100%",padding:"10px 16px",display:"flex",alignItems:"center",gap:"12px",textAlign:"left",fontSize:"14px",fontWeight:500,background:"transparent",border:"none",cursor:s.disabled?"not-allowed":"pointer",opacity:s.disabled?.5:1,color:s.danger?p.error:p.textPrimary},whileHover:s.disabled?void 0:{background:s.danger?`${p.error}15`:"rgba(255, 255, 255, 0.05)"},children:[r&&e.jsx(r,{size:18}),e.jsx("span",{children:s.label})]},m)})]})})})]})},Be={bgCardLit:"linear-gradient(165deg, #2a2722 0%, #1e1c18 50%, #1a1816 100%)",textPrimary:"#ffffff",textSecondary:"rgba(255, 255, 255, 0.75)",textMuted:"rgba(255, 255, 255, 0.5)",cardShadowLit:"0 8px 32px rgba(0, 0, 0, 0.5), 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255,255,255,0.06)"},Fe=l=>{const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(l);return a?`${parseInt(a[1],16)}, ${parseInt(a[2],16)}, ${parseInt(a[3],16)}`:"106, 212, 160"},Ge=({icon:l,title:a,description:g,actionLabel:x,onAction:w})=>{const{colors:f}=_(),p=u.useMemo(()=>({...Be,accent:f.accent,accentLight:f.accentLight,border:`rgba(${Fe(f.accent)}, 0.15)`}),[f]);return e.jsxs("div",{style:{background:p.bgCardLit,border:`1px solid ${p.border}`,borderRadius:"28px",boxShadow:p.cardShadowLit,position:"relative",overflow:"hidden",padding:"48px 24px"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:"25%",right:"25%",height:"1px",background:`linear-gradient(90deg, transparent, ${p.accentLight}4D, transparent)`}}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{display:"inline-flex",padding:"16px",background:`${p.accent}15`,borderRadius:"20px",marginBottom:"16px"},children:e.jsx(l,{size:48,style:{color:p.textMuted}})}),e.jsx("h3",{style:{fontSize:"20px",fontWeight:600,color:p.textPrimary,marginBottom:"8px"},children:a}),e.jsx("p",{style:{fontSize:"14px",color:p.textMuted,marginBottom:"24px",maxWidth:"400px",marginLeft:"auto",marginRight:"auto"},children:g}),x&&w&&e.jsx(T,{variant:"primary",onClick:w,children:x})]})]})},Ve=({scena:l,executing:a,onExecute:g,onDelete:x,onSchedule:w,onToggleShortcut:f,onEdit:p})=>{var v,M,R;const{colors:i}=Ae(),k=((v=l.azioni)==null?void 0:v.length)||0,z=l.is_shortcut!==!1&&l.is_shortcut!==0,L={position:"absolute",top:0,left:"25%",right:"25%",height:"1px",background:`linear-gradient(90deg, transparent, ${i.accentLight}4D, transparent)`},j=[];return f&&j.push({label:z?"Rimuovi dalle scorciatoie":"Aggiungi alle scorciatoie",icon:z?he:G,onClick:()=>f(!z)}),p&&j.push({label:"Modifica",icon:V,onClick:p}),j.push({label:"Programmazione",icon:D,onClick:w}),!l.is_base&&x&&j.push({label:"Elimina",icon:Y,onClick:x,danger:!0}),e.jsx(_e,{items:j,children:e.jsxs(y.div,{onClick:h=>{h.target.closest("button")||g()},style:{background:a?`linear-gradient(165deg, ${i.accent}15, ${i.bgCardLit.split(",")[1]}`:i.bgCardLit,border:`1px solid ${a?i.accent:i.border}`,borderRadius:"20px",boxShadow:a?`0 0 20px ${i.accent}30, ${i.cardShadowLit}`:i.cardShadowLit,position:"relative",overflow:"hidden",padding:"10px",cursor:"pointer"},whileHover:{scale:1.02,borderColor:i.borderHover},whileTap:{scale:.98},children:[e.jsx("div",{style:L}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",minWidth:0,flex:1},children:[e.jsx(y.div,{animate:a?{scale:[1,1.1,1]}:{},transition:a?{repeat:1/0,duration:1}:{},style:{flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px",padding:"6px",borderRadius:"10px",background:`${i.accent}15`},children:a?e.jsx(q,{size:22,style:{color:i.accent},className:"animate-spin"}):e.jsx(ee,{iconId:l.icona,size:22,style:{color:i.accentLight,filter:`drop-shadow(0 0 4px ${i.accent}50)`}})}),e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:600,color:i.textPrimary,margin:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:l.nome}),l.is_base&&e.jsx("span",{style:{padding:"2px 6px",fontSize:"9px",fontWeight:600,background:`${i.accent}20`,color:i.accent,borderRadius:"4px",flexShrink:0},children:"BASE"}),z&&e.jsx(G,{size:12,style:{color:i.accentLight,flexShrink:0}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"4px"},children:[e.jsxs("span",{style:{fontSize:"11px",color:i.textMuted},children:[k," dispositiv",k===1?"o":"i"]}),((M=l.scheduling)==null?void 0:M.enabled)&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:i.success},children:[e.jsx(D,{size:11}),"Programmata"]})]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexShrink:0,marginLeft:"10px"},children:[e.jsx(y.button,{onClick:h=>{h.stopPropagation(),g()},style:{padding:"8px",borderRadius:"10px",background:`${i.accent}15`,border:`1px solid ${i.accent}30`,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.1,background:`${i.accent}25`},whileTap:{scale:.9},title:"Esegui",children:e.jsx(K,{size:14,style:{color:i.accent}})}),p&&e.jsx(y.button,{onClick:h=>{h.stopPropagation(),p()},style:{padding:"8px",borderRadius:"10px",background:"transparent",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.1,background:"rgba(255,255,255,0.1)"},whileTap:{scale:.9},title:"Modifica",children:e.jsx(V,{size:14,style:{color:i.textMuted}})}),e.jsx(y.button,{onClick:h=>{h.stopPropagation(),w()},style:{padding:"8px",borderRadius:"10px",background:"transparent",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.1,background:"rgba(255,255,255,0.1)"},whileTap:{scale:.9},title:"Programmazione",children:e.jsx(D,{size:14,style:{color:(R=l.scheduling)!=null&&R.enabled?i.success:i.textMuted}})}),!l.is_base&&x&&e.jsx(y.button,{onClick:h=>{h.stopPropagation(),x()},style:{padding:"8px",borderRadius:"10px",background:"transparent",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.1,background:`${i.error}20`},whileTap:{scale:.9},title:"Elimina",children:e.jsx(Y,{size:14,style:{color:`${i.error}99`}})})]})]})]})})},Ye=u.memo(Ve),Xe={hidden:{opacity:0,y:30,scale:.95},show:{opacity:1,y:0,scale:1,transition:{duration:.4,ease:"easeOut"}}},Ue={hidden:{},show:{transition:{staggerChildren:.1}}},qe=({scene:l,executingId:a,onExecute:g,onDelete:x,onSchedule:w,onToggleShortcut:f,onEdit:p})=>e.jsx(y.div,{initial:"hidden",animate:"show",variants:Ue,style:{display:"flex",flexDirection:"column",gap:"10px"},children:l.filter(i=>i!=null).map(i=>e.jsx(y.div,{variants:Xe,whileTap:{scale:.98},children:e.jsx(Ye,{scena:i,executing:a===i.id,onExecute:()=>g(i.id),onDelete:i.is_base?void 0:()=>x(i.id),onSchedule:()=>w(i),onToggleShortcut:k=>f(i.id,k),onEdit:()=>p(i)})},i.id))}),U=l=>{const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(l);return a?`${parseInt(a[1],16)}, ${parseInt(a[2],16)}, ${parseInt(a[3],16)}`:"106, 212, 160"},N=[{id:"zap",icon:J,label:"Energia"},{id:"sun",icon:ge,label:"Giorno"},{id:"moon",icon:fe,label:"Notte"},{id:"door",icon:me,label:"Porta"},{id:"hand",icon:be,label:"Ciao"},{id:"movie",icon:ye,label:"Cinema"},{id:"lightbulb",icon:Z,label:"Luce"},{id:"sunrise",icon:je,label:"Alba"},{id:"sunset",icon:ve,label:"Tramonto"},{id:"home",icon:Se,label:"Casa"},{id:"flame",icon:Ce,label:"Fuoco"},{id:"snow",icon:we,label:"Freddo"},{id:"coffee",icon:ze,label:"CaffÃ¨"},{id:"bed",icon:ke,label:"Letto"},{id:"tv",icon:Le,label:"TV"},{id:"music",icon:$e,label:"Musica"},{id:"shield",icon:Re,label:"Sicurezza"},{id:"heart",icon:Me,label:"Amore"}],Ke={"âš¡":"zap","â˜€ï¸":"sun","ðŸŒ™":"moon","ðŸšª":"door","ðŸ‘‹":"hand","ðŸŽ¬":"movie","ðŸ’¡":"lightbulb","ðŸŒ…":"sunrise","ðŸŒ‡":"sunset","ðŸ ":"home","ðŸ”¥":"flame","â„ï¸":"snow","â˜•":"coffee","ðŸ›ï¸":"bed","ðŸ“º":"tv","ðŸŽµ":"music","ðŸ›¡ï¸":"shield","â¤ï¸":"heart"},Q=l=>{const a=Ke[l]||l,g=N.find(x=>x.id===a);return g?g.icon:J},ee=({iconId:l,size:a=24,style:g})=>{const x=Q(l);return e.jsx(x,{size:a,style:g,className:"remix-icon"})},Je=()=>{const{impiantoCorrente:l}=Te(),{colors:a,modeColors:g}=_(),{scene:x,loading:w}=Pe(),{dispositivi:f,loading:p}=We(),[i,k]=u.useState(null),[z,L]=u.useState(!1),[j,v]=u.useState(!1),[M,R]=u.useState(!1),[h,I]=u.useState(null),[H,E]=u.useState(!1),[s,m]=u.useState(null),[r,b]=u.useState({nome:"",icona:"zap",azioni:[]}),[c,$]=u.useState({enabled:!1,time:"18:00",mode:"daily",days:[]}),O=w||p,n=u.useMemo(()=>({...g,accent:a.accent,accentLight:a.accentLight,accentDark:a.accentDark,border:`rgba(${U(a.accent)}, 0.15)`,borderHover:`rgba(${U(a.accent)}, 0.35)`}),[a,g]),B=["Entra","Esci","Giorno","Notte"],te=u.useMemo(()=>[...x].sort((t,o)=>{const d=B.indexOf(t.nome),S=B.indexOf(o.nome);return d!==-1&&S!==-1?d-S:d!==-1?-1:S!==-1?1:t.nome.localeCompare(o.nome)}),[x]),ne=async t=>{k(t);try{const o=await P.executeScena(t);o!=null&&o.bloccati&&o.bloccati>0?C.warning(`Eseguita (${o.bloccati} bloccat${o.bloccati===1?"o":"i"})`):C.success("OK")}catch(o){console.error("Errore esecuzione scena:",o),C.error("Errore")}finally{k(null)}},ie=(l==null?void 0:l.id)||0,oe=async()=>{if(!r.nome){C.error("Nome richiesto");return}try{L(!0),await P.createScena(ie,r),C.success("Creata"),v(!1),b({nome:"",icona:"zap",azioni:[]})}catch{C.error("Errore")}finally{L(!1)}},ae=async t=>{if(confirm("Eliminare la scena?"))try{await P.deleteScena(t),C.success("Eliminata")}catch{C.error("Errore")}},re=async(t,o)=>{try{await P.toggleShortcut(t,o),C.success(o?"Aggiunta":"Rimossa")}catch{C.error("Errore")}},se=t=>{I(t);let o=[];try{typeof t.azioni=="string"?o=JSON.parse(t.azioni||"[]"):Array.isArray(t.azioni)&&(o=t.azioni)}catch{o=[]}b({nome:t.nome,icona:t.icona,azioni:o}),R(!0)},le=async()=>{if(h)try{L(!0),await P.updateScena(h.id,{nome:r.nome,icona:r.icona,azioni:r.azioni}),C.success("Salvata"),R(!1),I(null),b({nome:"",icona:"zap",azioni:[]})}catch{C.error("Errore")}finally{L(!1)}},ce=(t,o)=>{const d=r.azioni.find(S=>S.dispositivo_id===t);b(d?{...r,azioni:r.azioni.filter(S=>S.dispositivo_id!==t)}:{...r,azioni:[...r.azioni,{dispositivo_id:t,topic:o,stato:"ON"}]})},de=(t,o)=>{b({...r,azioni:r.azioni.map(d=>d.dispositivo_id===t?{...d,stato:o}:d)})},pe=t=>{m(t),$(t.scheduling||{enabled:!1,time:"18:00",mode:"daily",days:[]}),E(!0)},xe=async()=>{if(s)try{await P.updateScena(s.id,{scheduling:c.enabled?c:null}),C.success("Salvata"),E(!1)}catch{C.error("Errore")}},ue=t=>{const o=c.days||[];o.includes(t)?$({...c,days:o.filter(d=>d!==t)}):$({...c,days:[...o,t]})},F=()=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"240px",overflowY:"auto"},children:f.filter(t=>t!=null).map(t=>{const o=r.azioni.find(S=>S.dispositivo_id===t.id),d=!!o;return e.jsx("div",{style:{padding:"12px",borderRadius:"16px",background:d?`${n.accent}15`:"rgba(255,255,255,0.05)",border:d?`2px solid ${n.accent}`:"2px solid transparent"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(y.button,{onClick:()=>ce(t.id,t.topic_mqtt||""),style:{display:"flex",alignItems:"center",gap:"12px",flex:1,textAlign:"left",background:"transparent",border:"none",cursor:"pointer"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",background:d?n.accent:"transparent",border:d?"none":`2px solid ${n.border}`},children:d&&e.jsx(Ee,{size:14,style:{color:"#0a0a0c"}})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Z,{size:16,style:{color:d?n.accent:n.textMuted}}),e.jsx("span",{style:{fontSize:"14px",fontWeight:500,color:d?n.textPrimary:n.textMuted},children:t.nome})]})]}),d&&e.jsxs(y.button,{onClick:S=>{S.stopPropagation(),de(t.id,o.stato==="ON"?"OFF":"ON")},style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",borderRadius:"10px",background:o.stato==="ON"?`${n.accent}20`:"rgba(255,255,255,0.05)",border:`1px solid ${o.stato==="ON"?n.accent:n.border}`,cursor:"pointer"},whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Oe,{size:14,style:{color:o.stato==="ON"?n.accent:n.textMuted}}),e.jsx("span",{style:{fontSize:"12px",fontWeight:600,color:o.stato==="ON"?n.accent:n.textMuted},children:o.stato})]})]})},t.id)})});return e.jsxs(He,{children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:n.textPrimary,margin:0},children:"Scene"}),e.jsx("p",{style:{fontSize:"13px",color:n.textMuted,margin:"4px 0 0 0"},children:"Tap per eseguire"})]}),e.jsx(y.button,{onClick:()=>v(!0),style:{width:"44px",height:"44px",padding:0,borderRadius:"16px",background:`linear-gradient(135deg, ${a.accent}, ${a.accentDark})`,border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:`0 4px 20px ${a.accent}50`},whileHover:{scale:1.05,boxShadow:`0 6px 24px ${a.accent}60`},whileTap:{scale:.95},children:e.jsx(Ie,{size:20,style:{color:g.bg,display:"block"}})})]}),O?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"48px 0"},children:e.jsx(q,{size:32,className:"animate-spin",style:{color:n.accent}})}):x.length===0?e.jsx(Ge,{icon:K,title:"Nessuna scena",description:"Crea la tua prima scena usando il pulsante in alto"}):e.jsx(qe,{scene:te,executingId:i,onExecute:ne,onDelete:ae,onSchedule:pe,onToggleShortcut:re,onEdit:se})]}),e.jsx(A,{isOpen:j,onClose:()=>v(!1),title:"Nuova Scena",size:"md",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx(W,{label:"Nome Scena",value:r.nome,onChange:t=>b({...r,nome:t.target.value}),placeholder:"es. Cinema"}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.1em",color:n.textMuted,marginBottom:"8px"},children:"Icona"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"8px"},children:N.map(({id:t,icon:o,label:d})=>e.jsx(y.button,{onClick:()=>b({...r,icona:t}),title:d,style:{padding:"12px",borderRadius:"12px",border:r.icona===t?`2px solid ${n.accent}`:`2px solid ${n.border}`,background:r.icona===t?`${n.accent}20`:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.05,borderColor:n.borderHover},whileTap:{scale:.95},children:e.jsx(o,{size:22,style:{color:r.icona===t?n.accent:n.textMuted,filter:r.icona===t?`drop-shadow(0 0 4px ${n.accent})`:"none"}})},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.1em",color:n.textMuted,marginBottom:"8px"},children:["Dispositivi (",r.azioni.length," selezionati)"]}),F()]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[e.jsx(T,{variant:"ghost",onClick:()=>v(!1),fullWidth:!0,children:"Annulla"}),e.jsx(T,{variant:"primary",onClick:oe,fullWidth:!0,disabled:z,children:z?"Creazione...":"Crea Scena"})]})]})}),e.jsx(A,{isOpen:H,onClose:()=>E(!1),title:"Programmazione Scena",size:"md",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px",background:"rgba(255,255,255,0.05)",borderRadius:"12px"},children:[e.jsx("span",{style:{fontWeight:500,color:n.textPrimary},children:"Programmazione Attiva"}),e.jsx("button",{onClick:()=>$({...c,enabled:!c.enabled}),style:{width:"48px",height:"24px",borderRadius:"9999px",background:c.enabled?n.success:"#6b7280",border:"none",cursor:"pointer",position:"relative"},children:e.jsx("div",{style:{width:"20px",height:"20px",background:"#ffffff",borderRadius:"50%",position:"absolute",top:"2px",left:c.enabled?"26px":"2px",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.3)"}})})]}),c.enabled&&e.jsxs(e.Fragment,{children:[e.jsx(W,{label:"Orario",type:"time",value:c.time,onChange:t=>$({...c,time:t.target.value})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.1em",color:n.textMuted,marginBottom:"8px"},children:"ModalitÃ "}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[{id:"daily",label:"Giornaliero"},{id:"weekly",label:"Settimanale"},{id:"once",label:"Una tantum"}].map(({id:t,label:o})=>e.jsx(y.button,{onClick:()=>$({...c,mode:t}),style:{padding:"10px",fontSize:"12px",borderRadius:"12px",border:c.mode===t?`2px solid ${n.accent}`:`2px solid ${n.border}`,background:c.mode===t?`${n.accent}20`:"transparent",color:c.mode===t?n.textPrimary:n.textMuted,cursor:"pointer"},whileTap:{scale:.95},children:o},t))})]}),c.mode==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.1em",color:n.textMuted,marginBottom:"8px"},children:"Giorni"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px"},children:["D","L","M","M","G","V","S"].map((t,o)=>{var d,S;return e.jsx(y.button,{onClick:()=>ue(o),style:{padding:"8px",fontSize:"11px",fontWeight:600,borderRadius:"8px",background:(d=c.days)!=null&&d.includes(o)?n.accent:"rgba(255,255,255,0.05)",color:(S=c.days)!=null&&S.includes(o)?"#0a0a0c":n.textMuted,border:"none",cursor:"pointer"},whileTap:{scale:.95},children:t},o)})})]}),c.mode==="once"&&e.jsx(W,{label:"Data",type:"date",value:c.date||"",onChange:t=>$({...c,date:t.target.value})})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[e.jsx(T,{variant:"ghost",onClick:()=>E(!1),fullWidth:!0,children:"Annulla"}),e.jsx(T,{variant:"primary",onClick:xe,fullWidth:!0,children:"Salva"})]})]})}),e.jsx(A,{isOpen:M,onClose:()=>{R(!1),I(null),b({nome:"",icona:"âš¡",azioni:[]})},title:`Modifica ${(h==null?void 0:h.nome)||"Scena"}`,size:"md",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx(W,{label:"Nome Scena",value:r.nome,onChange:t=>b({...r,nome:t.target.value}),placeholder:"es. Cinema",disabled:h==null?void 0:h.is_base}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.1em",color:n.textMuted,marginBottom:"8px"},children:"Icona"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"8px"},children:N.map(({id:t,icon:o,label:d})=>e.jsx(y.button,{onClick:()=>b({...r,icona:t}),title:d,style:{padding:"12px",borderRadius:"12px",border:r.icona===t?`2px solid ${n.accent}`:`2px solid ${n.border}`,background:r.icona===t?`${n.accent}20`:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.05,borderColor:n.borderHover},whileTap:{scale:.95},children:e.jsx(o,{size:22,style:{color:r.icona===t?n.accent:n.textMuted,filter:r.icona===t?`drop-shadow(0 0 4px ${n.accent})`:"none"}})},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.1em",color:n.textMuted,marginBottom:"8px"},children:["Dispositivi (",r.azioni.length," selezionati)"]}),F()]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[e.jsx(T,{variant:"ghost",onClick:()=>{R(!1),I(null),b({nome:"",icona:"âš¡",azioni:[]})},fullWidth:!0,children:"Annulla"}),e.jsx(T,{variant:"primary",onClick:le,fullWidth:!0,disabled:z,children:z?"Salvataggio...":"Salva Modifiche"})]})]})})]})},rt=Object.freeze(Object.defineProperty({__proto__:null,Scene:Je,SceneIcon:ee,getSceneIcon:Q},Symbol.toStringTag,{value:"Module"}));export{_e as C,ee as S,rt as a};
