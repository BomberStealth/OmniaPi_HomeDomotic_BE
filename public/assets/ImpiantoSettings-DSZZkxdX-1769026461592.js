import{x as T,w as A,a as H,u as E,X as B,r as m,j as e,O as w,g as N,M as F,aK as _,a1 as V,aL as O,H as x,az as G,a0 as U,Y as K,a8 as X,m as Y,a3 as q,N as J,$ as Q}from"./index-B7WG_kHJ-1769026461592.js";import{L as k}from"./Layout-BnB1agDJ-1769026461592.js";import{m as a}from"./motion-DSM7Rpg2-1769026461592.js";import{A as Z}from"./index-yirOBEcN-1769026461592.js";import"./useTranslation-CnXjuBvM-1769026461592.js";import"./responsive-BJrBEfWo-1769026461592.js";import"./omniapiApi-DDnppdd_-1769026461592.js";function I(s){const d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return d?`${parseInt(d[1],16)}, ${parseInt(d[2],16)}, ${parseInt(d[3],16)}`:"106, 212, 160"}const S={hidden:{opacity:0,y:30,scale:.95},show:{opacity:1,y:0,scale:1,transition:{duration:.4,ease:"easeOut"}}},ee={hidden:{},show:{transition:{staggerChildren:.1}}},le=()=>{const{colors:s,modeColors:d}=T(),{impiantoCorrente:t,setImpiantoCorrente:$}=A(),{user:r}=H(),y=E(),R=(r==null?void 0:r.ruolo)===B.ADMIN||(t==null?void 0:t.utente_id)===(r==null?void 0:r.id)||(t==null?void 0:t.installatore_id)===(r==null?void 0:r.id),[f,g]=m.useState(!1),[p,C]=m.useState(!1),[n,h]=m.useState({nome:"",indirizzo:"",citta:"",cap:""}),i={...d,accent:s.accent,accentLight:s.accentLight,accentDark:s.accentDark,border:`rgba(${I(s.accent)}, 0.15)`,borderHover:`rgba(${I(s.accent)}, 0.35)`},b={background:i.bgCardLit,border:`1px solid ${i.border}`,borderRadius:"20px",boxShadow:i.cardShadowLit,position:"relative",overflow:"hidden"},j={position:"absolute",top:0,left:"25%",right:"25%",height:"1px",background:`linear-gradient(90deg, transparent, ${i.accentLight}4D, transparent)`,pointerEvents:"none"};if(m.useEffect(()=>{f&&t&&h({nome:t.nome||"",indirizzo:t.indirizzo||"",citta:t.citta||"",cap:t.cap||""})},[f,t]),!t)return e.jsx(k,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"48px 16px",gap:"16px"},children:[e.jsx(w,{size:48,style:{color:i.textMuted,opacity:.5}}),e.jsx("p",{style:{color:i.textSecondary,textAlign:"center"},children:"Seleziona un impianto per accedere alle impostazioni"}),e.jsx(a.button,{onClick:()=>y("/dashboard"),style:{padding:"12px 24px",borderRadius:"12px",background:`${i.accent}20`,border:`1px solid ${i.accent}50`,color:i.accent,fontWeight:600,cursor:"pointer"},whileHover:{scale:1.02},whileTap:{scale:.98},children:"Vai alla Dashboard"})]})});const v=()=>{t.codice_condivisione&&(navigator.clipboard.writeText(t.codice_condivisione),x.success("Codice copiato!"))},L=async()=>{const o=t.codice_condivisione;if(!o){x.error("Codice non disponibile");return}const l={title:"OmniaPi - Codice Impianto",text:`Unisciti al mio impianto "${t.nome}" su OmniaPi!

Codice: ${o}`};if(navigator.share&&navigator.canShare&&navigator.canShare(l))try{await navigator.share(l)}catch(c){c.name!=="AbortError"&&(console.error("Errore condivisione:",c),v())}else v()},M=async()=>{var o,l;if(!n.nome.trim()){x.error("Inserisci il nome dell'impianto");return}C(!0);try{(await Q.update(t.id,n)).success&&($({...t,...n}),x.success("Modifiche salvate!"),g(!1))}catch(c){x.error(((l=(o=c.response)==null?void 0:o.data)==null?void 0:l.error)||"Errore durante il salvataggio")}finally{C(!1)}},z=({icon:o,iconBg:l,title:c,subtitle:P,onClick:u,rightElement:D,showArrow:W=!0})=>e.jsxs(a.div,{onClick:u,style:{...b,padding:"12px",cursor:u?"pointer":"default"},whileHover:u?{scale:1.01}:void 0,whileTap:u?{scale:.99}:void 0,children:[e.jsx("div",{style:j}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{padding:"8px",borderRadius:"12px",background:l},children:e.jsx(o,{size:18,style:{color:i.accent}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:500,color:i.textPrimary,margin:0},children:c}),e.jsx("p",{style:{fontSize:"11px",color:i.textMuted,margin:"2px 0 0 0"},children:P})]})]}),D||W&&e.jsx(J,{size:18,style:{color:i.textMuted}})]})]});return e.jsxs(k,{children:[e.jsxs(a.div,{initial:"hidden",animate:"show",variants:ee,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(a.button,{onClick:()=>y(-1),style:{padding:"10px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(N,{size:20,color:i.textSecondary})}),e.jsx("div",{style:{flex:1},children:e.jsx("h1",{style:{fontSize:"20px",fontWeight:700,color:i.textPrimary,margin:0},children:"Impostazioni Impianto"})})]}),e.jsxs(a.div,{variants:S,style:{...b,padding:"16px"},children:[e.jsx("div",{style:j}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flex:1},children:[e.jsx("div",{style:{width:"52px",height:"52px",borderRadius:"50%",background:`linear-gradient(135deg, ${i.accent}30, ${i.accentDark}20)`,border:`1px solid ${i.accent}40`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(w,{size:24,style:{color:i.accent}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:i.textPrimary,margin:0},children:t.nome}),e.jsxs("p",{style:{fontSize:"13px",color:i.textMuted,margin:"4px 0 0 0",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(F,{size:14}),t.citta||"Posizione non specificata"]})]})]}),R&&e.jsx(a.button,{onClick:()=>g(!0),style:{padding:"10px",borderRadius:"12px",background:`${i.accent}15`,border:`1px solid ${i.accent}30`,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.05,background:`${i.accent}25`},whileTap:{scale:.95},children:e.jsx(_,{size:18,color:i.accent})})]}),e.jsx("div",{style:{padding:"12px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"11px",color:i.textMuted,margin:0,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Codice Impianto"}),e.jsx("p",{style:{fontSize:"20px",fontWeight:700,color:i.textPrimary,margin:"4px 0 0 0",fontFamily:"monospace",letterSpacing:"0.1em"},children:t.codice_condivisione||"N/A"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(a.button,{onClick:v,style:{padding:"10px",borderRadius:"10px",background:`${i.accent}15`,border:`1px solid ${i.accent}30`,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.05},whileTap:{scale:.95},title:"Copia codice",children:e.jsx(V,{size:18,color:i.accent})}),e.jsx(a.button,{onClick:L,style:{padding:"10px",borderRadius:"10px",background:`linear-gradient(135deg, ${i.accent}, ${i.accentDark})`,border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},whileHover:{scale:1.05},whileTap:{scale:.95},title:"Condividi",children:e.jsx(O,{size:18,color:"#fff"})})]})]})})]}),e.jsxs(a.div,{variants:S,style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsx("h2",{style:{fontSize:"12px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",color:i.textMuted,margin:"0 4px"},children:"Impostazioni"}),e.jsx(z,{icon:G,iconBg:`${i.accent}20`,title:"Preferenze Notifiche",subtitle:"In arrivo",onClick:()=>x.info("FunzionalitÃ  in arrivo")}),e.jsx(z,{icon:U,iconBg:`${i.success}20`,title:"Gestione Condivisioni",subtitle:"Gestisci accessi e inviti",onClick:()=>y("/impianto/condivisioni")}),e.jsx(z,{icon:K,iconBg:`${i.warning}20`,title:"Impostazioni Avanzate",subtitle:"Elimina impianto, rigenera codice",onClick:()=>y(`/impianti/${t.id}/settings`)})]}),e.jsxs(a.div,{variants:S,style:{...b,padding:"24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("div",{style:j}),e.jsx("span",{style:{fontSize:"32px"},children:"ðŸ—ºï¸"}),e.jsx("p",{style:{fontSize:"14px",color:i.textSecondary,margin:0},children:"Mappa in arrivo"}),e.jsx("p",{style:{fontSize:"12px",color:i.textMuted,margin:0},children:"Visualizza la posizione del tuo impianto"})]})]}),e.jsx(Z,{children:f&&e.jsxs(e.Fragment,{children:[e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",zIndex:100},onClick:()=>g(!1)}),e.jsxs(a.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"calc(100% - 32px)",maxWidth:"400px",background:i.bgCardLit,borderRadius:"20px",padding:"20px",zIndex:101,border:`1px solid ${i.border}`,boxShadow:i.cardShadowLit},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:i.textPrimary,margin:0},children:"Modifica Impianto"}),e.jsx(a.button,{onClick:()=>g(!1),style:{padding:"8px",borderRadius:"10px",background:"transparent",border:"none",cursor:"pointer"},whileHover:{background:`${i.textMuted}20`},children:e.jsx(X,{size:20,color:i.textMuted})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"14px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"12px",fontWeight:500,color:i.textSecondary,display:"block",marginBottom:"6px"},children:"Nome Impianto *"}),e.jsx("input",{type:"text",value:n.nome,onChange:o=>h({...n,nome:o.target.value}),placeholder:"es. Casa Principale",style:{width:"100%",padding:"12px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`,color:i.textPrimary,fontSize:"14px",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"12px",fontWeight:500,color:i.textSecondary,display:"block",marginBottom:"6px"},children:"Indirizzo"}),e.jsx("input",{type:"text",value:n.indirizzo,onChange:o=>h({...n,indirizzo:o.target.value}),placeholder:"es. Via Roma 123",style:{width:"100%",padding:"12px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`,color:i.textPrimary,fontSize:"14px",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("div",{style:{flex:2},children:[e.jsx("label",{style:{fontSize:"12px",fontWeight:500,color:i.textSecondary,display:"block",marginBottom:"6px"},children:"CittÃ "}),e.jsx("input",{type:"text",value:n.citta,onChange:o=>h({...n,citta:o.target.value}),placeholder:"es. Milano",style:{width:"100%",padding:"12px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`,color:i.textPrimary,fontSize:"14px",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{fontSize:"12px",fontWeight:500,color:i.textSecondary,display:"block",marginBottom:"6px"},children:"CAP"}),e.jsx("input",{type:"text",value:n.cap,onChange:o=>h({...n,cap:o.target.value}),placeholder:"20100",maxLength:5,style:{width:"100%",padding:"12px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`,color:i.textPrimary,fontSize:"14px",outline:"none",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"8px"},children:[e.jsx(a.button,{onClick:()=>g(!1),style:{flex:1,padding:"14px",borderRadius:"12px",background:i.bgCard,border:`1px solid ${i.border}`,color:i.textSecondary,fontSize:"14px",fontWeight:600,cursor:"pointer"},whileHover:{scale:1.02},whileTap:{scale:.98},children:"Annulla"}),e.jsx(a.button,{onClick:M,disabled:p||!n.nome.trim(),style:{flex:1,padding:"14px",borderRadius:"12px",background:`linear-gradient(135deg, ${i.accent}, ${i.accentDark})`,border:"none",color:"#fff",fontSize:"14px",fontWeight:600,cursor:p||!n.nome.trim()?"not-allowed":"pointer",opacity:p||!n.nome.trim()?.6:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},whileHover:!p&&n.nome.trim()?{scale:1.02}:{},whileTap:!p&&n.nome.trim()?{scale:.98}:{},children:p?e.jsx(Y,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsxs(e.Fragment,{children:[e.jsx(q,{size:18}),"Salva"]})})]})]})]})]})}),e.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]})};export{le as ImpiantoSettings,le as default};
