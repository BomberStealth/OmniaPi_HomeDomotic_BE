import{l as T,u as W,r,j as e,n as H,s as D,c as $,t as L,v as C,d as G,L as Z,p as O}from"./index-B7WG_kHJ-1769026461592.js";import{m as o}from"./motion-DSM7Rpg2-1769026461592.js";import{A as V}from"./index-yirOBEcN-1769026461592.js";const t={accent:"#6ad4a0",accentLight:"#a0e8c4",border:"rgba(106, 212, 160, 0.15)",borderGlow:"rgba(106, 212, 160, 0.4)",textMuted:"rgba(255, 255, 255, 0.5)",textPrimary:"#ffffff",bgCard:"rgba(20, 18, 15, 0.7)",error:"#ef4444",success:"#10b981",warning:"#f59e0b"},q=s=>{const i=[];return s.length<8&&i.push("Minimo 8 caratteri"),/[a-z]/.test(s)||i.push("Almeno una lettera minuscola"),/[A-Z]/.test(s)||i.push("Almeno una lettera maiuscola"),/\d/.test(s)||i.push("Almeno un numero"),{valid:i.length===0,errors:i}},J=s=>{let i=0;return s.length>=8&&i++,s.length>=12&&i++,/[a-z]/.test(s)&&i++,/[A-Z]/.test(s)&&i++,/\d/.test(s)&&i++,/[^a-zA-Z\d]/.test(s)&&i++,i<=2?{strength:i,label:"Debole",color:t.error}:i<=4?{strength:i,label:"Media",color:t.warning}:{strength:i,label:"Forte",color:t.success}},K=({count:s=12})=>{const i=r.useMemo(()=>Array.from({length:s},(n,d)=>({id:d,size:2+Math.random()*3,left:Math.random()*100,delay:Math.random()*5,duration:10+Math.random()*10,opacity:.15+Math.random()*.25})),[s]);return e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",style:{zIndex:1},children:i.map(n=>e.jsx(o.div,{className:"absolute rounded-full",style:{width:n.size,height:n.size,left:`${n.left}%`,bottom:"-10px",background:t.accent,boxShadow:`0 0 ${n.size}px ${t.accent}`,opacity:n.opacity},animate:{y:[0,-window.innerHeight-50],opacity:[0,n.opacity,n.opacity,0]},transition:{duration:n.duration,delay:n.delay,repeat:1/0,ease:"linear"}},n.id))})},X=()=>{const[s]=T(),i=W(),n=s.get("token"),[d,P]=r.useState(""),[x,M]=r.useState(""),[y,N]=r.useState(!1),[f,R]=r.useState(!1),[b,u]=r.useState(""),[w,v]=r.useState([]),[c,k]=r.useState(!1),[B,I]=r.useState(!1),[a,F]=r.useState(!1),[p,g]=r.useState(null),h=J(d);r.useEffect(()=>{const l=()=>F(window.innerWidth<640);return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),r.useEffect(()=>{n||u("Link non valido. Token mancante.")},[n]);const A=async l=>{var S,z;l.preventDefault(),u(""),v([]);const{valid:j,errors:E}=q(d);if(!j){v(E);return}if(d!==x){u("Le password non corrispondono");return}k(!0);try{const m=await O.post("/api/auth/reset-password",{token:n,newPassword:d});m.data.success?(I(!0),setTimeout(()=>i("/login"),3e3)):u(m.data.error||"Errore durante il reset")}catch(m){u(((z=(S=m.response)==null?void 0:S.data)==null?void 0:z.error)||"Token non valido o scaduto.")}finally{k(!1)}};return e.jsxs("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",padding:a?"12px":"16px",overflow:"hidden",fontFamily:'"Plus Jakarta Sans", -apple-system, BlinkMacSystemFont, sans-serif'},children:[e.jsx(o.div,{className:"fixed inset-0",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},style:{background:`
            radial-gradient(ellipse 80% 50% at 50% -10%, rgba(106, 212, 160, 0.1) 0%, transparent 60%),
            radial-gradient(ellipse 60% 40% at 80% 100%, rgba(74, 168, 112, 0.06) 0%, transparent 50%),
            linear-gradient(to bottom, #12110f 0%, #0a0a09 100%)
          `,backgroundSize:"200% 200%",animation:"gradientMove 20s ease infinite"}}),e.jsx("style",{children:`
        @keyframes gradientMove {
          0%, 100% { background-position: 0% 0%; }
          50% { background-position: 100% 100%; }
        }
      `}),e.jsx(K,{count:a?8:15}),e.jsx("div",{className:"fixed top-0 left-0 right-0 pointer-events-none",style:{height:a?"150px":"250px",background:"radial-gradient(ellipse 100% 100% at 50% -30%, rgba(106, 212, 160, 0.12) 0%, transparent 70%)",zIndex:1}}),e.jsx(o.div,{className:"w-full relative",style:{maxWidth:a?"100%":"420px",zIndex:10},initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsxs("div",{style:{background:t.bgCard,backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:a?"20px":"28px",border:`1px solid ${t.border}`,boxShadow:"0 4px 24px rgba(0, 0, 0, 0.4), 0 0 60px rgba(106, 212, 160, 0.04)",padding:a?"24px":"36px",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:"15%",right:"15%",height:"1px",background:`linear-gradient(90deg, transparent, ${t.accent}50, transparent)`}}),B?e.jsxs(o.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[e.jsx(o.div,{className:"flex justify-center",style:{marginBottom:"20px"},initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:e.jsx("div",{style:{padding:a?"16px":"20px",borderRadius:"24px",background:`linear-gradient(145deg, ${t.success}35, ${t.success}15)`,border:`1px solid ${t.success}25`},children:e.jsx(H,{size:a?36:44,style:{color:t.success,filter:`drop-shadow(0 0 8px ${t.success})`}})})}),e.jsx("h1",{style:{fontSize:a?"22px":"28px",fontWeight:700,marginBottom:"12px",background:`linear-gradient(135deg, ${t.success}, ${t.accent})`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Password Aggiornata!"}),e.jsx("p",{style:{color:t.textMuted,fontSize:a?"13px":"15px",marginBottom:"24px",lineHeight:1.5},children:"La tua password è stata reimpostata con successo. Verrai reindirizzato al login..."}),e.jsx(o.div,{animate:{rotate:360},transition:{duration:1.5,repeat:1/0,ease:"linear"},style:{width:"24px",height:"24px",border:`2px solid ${t.accent}30`,borderTopColor:t.accent,borderRadius:"50%",margin:"0 auto"}})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center",style:{marginBottom:"24px"},children:[e.jsx(o.div,{className:"flex justify-center",style:{marginBottom:"16px"},initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.3,type:"spring",stiffness:200},children:e.jsx(o.div,{style:{padding:a?"14px":"18px",borderRadius:"24px",background:`linear-gradient(145deg, ${t.accent}35, ${t.accent}15)`,border:`1px solid ${t.accent}25`},animate:{boxShadow:[`0 0 15px ${t.accent}30`,`0 0 25px ${t.accent}45`,`0 0 15px ${t.accent}30`]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(D,{size:a?28:34,style:{color:t.accentLight,filter:`drop-shadow(0 0 8px ${t.accent})`}})})}),e.jsx(o.h1,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.4},style:{fontSize:a?"22px":"28px",fontWeight:700,marginBottom:"8px",background:`linear-gradient(135deg, ${t.accentLight}, ${t.accent})`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Nuova Password"}),e.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},style:{color:t.textMuted,fontSize:a?"13px":"14px",lineHeight:1.5},children:"Scegli una password sicura per il tuo account."})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(o.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:.6},style:{marginBottom:"12px"},children:[e.jsx("label",{style:{display:"block",fontSize:a?"12px":"13px",fontWeight:500,color:t.textMuted,marginBottom:"6px"},children:"Nuova Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:p==="password"?t.accent:t.textMuted,display:"flex",alignItems:"center"},children:e.jsx($,{size:a?16:18})}),e.jsx("input",{type:y?"text":"password",value:d,onChange:l=>P(l.target.value),onFocus:()=>g("password"),onBlur:()=>g(null),placeholder:"••••••••",disabled:c||!n,autoComplete:"new-password",style:{width:"100%",height:a?"44px":"50px",paddingLeft:a?"38px":"44px",paddingRight:"44px",fontSize:a?"14px":"15px",color:t.textPrimary,background:"rgba(255, 255, 255, 0.05)",border:`1px solid ${p==="password"?t.borderGlow:t.border}`,borderRadius:a?"12px":"14px",outline:"none",transition:"all 0.2s ease",boxShadow:p==="password"?`0 0 15px ${t.accent}25`:"none"}}),e.jsx("button",{type:"button",onClick:()=>N(!y),className:"absolute right-3 top-1/2 -translate-y-1/2",style:{background:"none",border:"none",color:t.textMuted,cursor:"pointer",padding:"4px"},children:y?e.jsx(L,{size:18}):e.jsx(C,{size:18})})]}),d&&e.jsx("div",{style:{marginTop:"8px"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{style:{flex:1,height:"4px",borderRadius:"2px",background:t.border,overflow:"hidden"},children:e.jsx(o.div,{initial:{width:0},animate:{width:`${h.strength/6*100}%`},style:{height:"100%",background:h.color}})}),e.jsx("span",{style:{fontSize:"11px",color:h.color},children:h.label})]})})]}),e.jsxs(o.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:.7},style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",fontSize:a?"12px":"13px",fontWeight:500,color:t.textMuted,marginBottom:"6px"},children:"Conferma Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:p==="confirm"?t.accent:t.textMuted,display:"flex",alignItems:"center"},children:e.jsx($,{size:a?16:18})}),e.jsx("input",{type:f?"text":"password",value:x,onChange:l=>M(l.target.value),onFocus:()=>g("confirm"),onBlur:()=>g(null),placeholder:"••••••••",disabled:c||!n,autoComplete:"new-password",style:{width:"100%",height:a?"44px":"50px",paddingLeft:a?"38px":"44px",paddingRight:"44px",fontSize:a?"14px":"15px",color:t.textPrimary,background:"rgba(255, 255, 255, 0.05)",border:`1px solid ${p==="confirm"?t.borderGlow:t.border}`,borderRadius:a?"12px":"14px",outline:"none",transition:"all 0.2s ease",boxShadow:p==="confirm"?`0 0 15px ${t.accent}25`:"none"}}),e.jsx("button",{type:"button",onClick:()=>R(!f),className:"absolute right-3 top-1/2 -translate-y-1/2",style:{background:"none",border:"none",color:t.textMuted,cursor:"pointer",padding:"4px"},children:f?e.jsx(L,{size:18}):e.jsx(C,{size:18})})]}),x&&e.jsx("p",{style:{fontSize:"11px",color:d===x?t.success:t.error,marginTop:"6px"},children:d===x?"Le password corrispondono":"Le password non corrispondono"})]}),e.jsx(V,{children:(b||w.length>0)&&e.jsx(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},style:{padding:"10px 12px",borderRadius:"10px",background:`${t.error}12`,border:`1px solid ${t.error}30`,marginBottom:"16px"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(G,{size:14,style:{color:t.error,flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[b&&e.jsx("p",{style:{fontSize:"12px",color:t.error,margin:0},children:b}),w.map((l,j)=>e.jsx("p",{style:{fontSize:"12px",color:t.warning,margin:0},children:l},j))]})]})})}),e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},style:{padding:"10px 12px",borderRadius:"10px",background:"rgba(255, 255, 255, 0.03)",marginBottom:"16px"},children:e.jsx("p",{style:{fontSize:"11px",color:t.textMuted,margin:0},children:"Requisiti: 8+ caratteri, maiuscola, minuscola, numero"})}),e.jsx(o.button,{type:"submit",disabled:c||!n,initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:.9},whileHover:{scale:1.015},whileTap:{scale:.985},style:{width:"100%",height:a?"46px":"52px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:a?"15px":"16px",fontWeight:600,color:"#0a0a09",background:`linear-gradient(135deg, ${t.accentLight}, ${t.accent})`,border:"none",borderRadius:a?"12px":"14px",cursor:c||!n?"not-allowed":"pointer",opacity:c||!n?.6:1,boxShadow:`0 4px 15px ${t.accent}25`,marginBottom:"16px"},children:c?e.jsxs(e.Fragment,{children:[e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},style:{width:"18px",height:"18px",border:"2px solid rgba(0,0,0,0.2)",borderTopColor:"#0a0a09",borderRadius:"50%"}}),e.jsx("span",{children:"Aggiornamento..."})]}):"Imposta Nuova Password"}),e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-center",children:e.jsx(Z,{to:"/login",style:{fontSize:a?"13px":"14px",color:t.accentLight,textDecoration:"none"},children:"Torna al Login"})})]})]})]})})]})};export{X as ResetPassword};
