import{x as A,u as N,r as i,j as e,g as T,c as C,aO as E,t as D,v as B,H as c,p as H}from"./index-B7WG_kHJ-1769026461592.js";import{L as O}from"./Layout-BnB1agDJ-1769026461592.js";import{I as m}from"./Input-Bz5_UG-L-1769026461592.js";import{B as U}from"./Button-BLF6EOYE-1769026461592.js";import{m as w}from"./motion-DSM7Rpg2-1769026461592.js";import"./index-yirOBEcN-1769026461592.js";import"./useTranslation-CnXjuBvM-1769026461592.js";import"./responsive-BJrBEfWo-1769026461592.js";import"./omniapiApi-DDnppdd_-1769026461592.js";const q={bgCardLit:"linear-gradient(165deg, #2a2722 0%, #1e1c18 50%, #1a1816 100%)",textPrimary:"#ffffff",textSecondary:"rgba(255, 255, 255, 0.75)",textMuted:"rgba(255, 255, 255, 0.5)",cardShadowLit:"0 8px 32px rgba(0, 0, 0, 0.5), 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255,255,255,0.06)",error:"#ef4444",success:"#22c55e"};function V(n){const o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return o?`${parseInt(o[1],16)}, ${parseInt(o[2],16)}, ${parseInt(o[3],16)}`:"106, 212, 160"}const _=()=>{const{colors:n}=A(),o=N(),[x,L]=i.useState(""),[a,P]=i.useState(""),[d,k]=i.useState(""),[u,z]=i.useState(!1),[g,R]=i.useState(!1),[h,$]=i.useState(!1),[f,b]=i.useState(!1),s={...q,accent:n.accent,accentLight:n.accentLight,border:`rgba(${V(n.accent)}, 0.15)`},j={background:s.bgCardLit,border:`1px solid ${s.border}`,borderRadius:"20px",boxShadow:s.cardShadowLit,position:"relative",overflow:"hidden"},v={position:"absolute",top:0,left:"25%",right:"25%",height:"1px",background:`linear-gradient(90deg, transparent, ${s.accentLight}4D, transparent)`,pointerEvents:"none"},l={length:a.length>=8,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/[0-9]/.test(a)},S=Object.values(l).every(Boolean),p=a===d&&d.length>0,I=async()=>{var t,r;if(!x){c.error("Inserisci la password attuale");return}if(!S){c.error("La nuova password non rispetta i requisiti");return}if(!p){c.error("Le password non coincidono");return}b(!0);try{await H.post("/api/auth/change-password",{currentPassword:x,newPassword:a}),c.success("Password aggiornata con successo"),o("/settings")}catch(M){c.error(((r=(t=M.response)==null?void 0:t.data)==null?void 0:r.error)||"Errore durante l'aggiornamento")}finally{b(!1)}},y=({show:t,onToggle:r})=>e.jsx("button",{type:"button",onClick:r,style:{background:"none",border:"none",color:s.textMuted,cursor:"pointer",padding:"4px"},children:t?e.jsx(D,{size:18}):e.jsx(B,{size:18})});return e.jsx(O,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(w.button,{onClick:()=>o("/settings"),style:{padding:"10px",borderRadius:"12px",background:`${s.accent}15`,border:`1px solid ${s.accent}30`,color:s.accent,cursor:"pointer"},whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(T,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:s.textPrimary,margin:0},children:"Cambia Password"}),e.jsx("p",{style:{fontSize:"12px",color:s.textMuted,margin:"4px 0 0 0"},children:"Modifica la tua password di accesso"})]})]}),e.jsxs(w.div,{style:{...j,padding:"24px"},initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("div",{style:v}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{padding:"16px",borderRadius:"50%",background:`${s.accent}15`},children:e.jsx(C,{size:32,style:{color:s.accent}})}),e.jsx("p",{style:{fontSize:"14px",color:s.textSecondary,margin:0,textAlign:"center"},children:"Scegli una password sicura per proteggere il tuo account"})]})]}),e.jsxs(w.div,{style:{...j,padding:"20px"},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("div",{style:v}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(m,{label:"Password Attuale",type:u?"text":"password",value:x,onChange:t=>L(t.target.value),placeholder:"Inserisci la password attuale"}),e.jsx("div",{style:{position:"absolute",right:"12px",top:"38px"},children:e.jsx(y,{show:u,onToggle:()=>z(!u)})})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(m,{label:"Nuova Password",type:g?"text":"password",value:a,onChange:t=>P(t.target.value),placeholder:"Inserisci la nuova password"}),e.jsx("div",{style:{position:"absolute",right:"12px",top:"38px"},children:e.jsx(y,{show:g,onToggle:()=>R(!g)})})]}),a.length>0&&e.jsxs("div",{style:{padding:"12px",borderRadius:"12px",background:`${s.accent}08`,border:`1px solid ${s.accent}20`},children:[e.jsx("p",{style:{fontSize:"11px",color:s.textMuted,margin:"0 0 8px 0"},children:"Requisiti password:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[{check:l.length,label:"Almeno 8 caratteri"},{check:l.uppercase,label:"Una lettera maiuscola"},{check:l.lowercase,label:"Una lettera minuscola"},{check:l.number,label:"Un numero"}].map(({check:t,label:r})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(E,{size:14,style:{color:t?s.success:s.textMuted}}),e.jsx("span",{style:{fontSize:"12px",color:t?s.success:s.textMuted},children:r})]},r))})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(m,{label:"Conferma Password",type:h?"text":"password",value:d,onChange:t=>k(t.target.value),placeholder:"Ripeti la nuova password"}),e.jsx("div",{style:{position:"absolute",right:"12px",top:"38px"},children:e.jsx(y,{show:h,onToggle:()=>$(!h)})}),d.length>0&&e.jsx("p",{style:{fontSize:"11px",color:p?s.success:s.error,margin:"4px 0 0 0"},children:p?"Le password coincidono":"Le password non coincidono"})]}),e.jsxs(U,{variant:"primary",onClick:I,disabled:f||!S||!p,className:"w-full mt-2",children:[e.jsx(C,{size:18,className:"mr-2"}),f?"Aggiornamento...":"Aggiorna Password"]})]})]})]})})};export{_ as CambiaPassword};
