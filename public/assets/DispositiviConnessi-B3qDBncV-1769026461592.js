import{x as R,u as k,r as d,p as b,H as u,j as e,g as E,m as j,aw as I,Z as M,aG as T,aA as A,aH as W,aI as H}from"./index-B7WG_kHJ-1769026461592.js";import{L as P}from"./Layout-BnB1agDJ-1769026461592.js";import{m as l}from"./motion-DSM7Rpg2-1769026461592.js";import"./index-yirOBEcN-1769026461592.js";import"./useTranslation-CnXjuBvM-1769026461592.js";import"./responsive-BJrBEfWo-1769026461592.js";import"./omniapiApi-DDnppdd_-1769026461592.js";const B={bgCardLit:"linear-gradient(165deg, #2a2722 0%, #1e1c18 50%, #1a1816 100%)",textPrimary:"#ffffff",textSecondary:"rgba(255, 255, 255, 0.75)",textMuted:"rgba(255, 255, 255, 0.5)",cardShadowLit:"0 8px 32px rgba(0, 0, 0, 0.5), 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255,255,255,0.06)",success:"#22c55e",danger:"#ef4444"};function G(r){const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return s?`${parseInt(s[1],16)}, ${parseInt(s[2],16)}, ${parseInt(s[3],16)}`:"106, 212, 160"}const N=r=>{const s=new Date(r),p=new Date().getTime()-s.getTime(),c=Math.floor(p/6e4),a=Math.floor(p/36e5),x=Math.floor(p/864e5);return c<1?"Adesso":c<60?`${c} min fa`:a<24?`${a} ore fa`:x<7?`${x} giorni fa`:s.toLocaleDateString("it-IT",{day:"2-digit",month:"short",year:"numeric"})},K=()=>{const{colors:r,modeColors:s}=R(),v=k(),[p,c]=d.useState(!0),[a,x]=d.useState([]),[w,S]=d.useState(null),[g,C]=d.useState(!1),i={...B,accent:r.accent,accentLight:r.accentLight,border:`rgba(${G(r.accent)}, 0.15)`,bgCard:s.bgCard},f={background:i.bgCard,border:`1px solid ${i.border}`,borderRadius:"20px",boxShadow:i.cardShadowLit,position:"relative",overflow:"hidden"},y={position:"absolute",top:0,left:"25%",right:"25%",height:"1px",background:`linear-gradient(90deg, transparent, ${i.accentLight}4D, transparent)`,pointerEvents:"none"},h=d.useCallback(async()=>{try{c(!0);const t=await b.get("/api/sessions");t.data.success&&x(t.data.data)}catch(t){console.error("Errore caricamento sessioni:",t),u.error("Errore nel caricamento delle sessioni")}finally{c(!1)}},[]);d.useEffect(()=>{h()},[h]);const z=async t=>{try{S(t),(await b.delete(`/api/sessions/${t}`)).data.success&&(u.success("Sessione terminata"),x(m=>m.filter(o=>o.id!==t)))}catch(n){console.error("Errore terminazione sessione:",n),u.error("Errore nella terminazione della sessione")}finally{S(null)}},L=async()=>{try{C(!0);const t=await b.delete("/api/sessions/all");t.data.success&&(u.success(t.data.message||"Tutte le sessioni terminate"),await h())}catch(t){console.error("Errore terminazione sessioni:",t),u.error("Errore nella terminazione delle sessioni")}finally{C(!1)}},$=t=>{const n=t.toLowerCase();return n.includes("iphone")||n.includes("android")||n.includes("mobile")||n.includes("phone")?A:n.includes("mac")||n.includes("ipad")?W:H},D=a.filter(t=>!t.isCurrent);return e.jsxs(P,{children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(l.button,{onClick:()=>v("/settings"),style:{padding:"10px",borderRadius:"12px",background:`${i.accent}15`,border:`1px solid ${i.accent}30`,color:i.accent,cursor:"pointer"},whileTap:{scale:.95},children:e.jsx(E,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:s.textPrimary,margin:0},children:"Dispositivi Connessi"}),e.jsxs("p",{style:{fontSize:"12px",color:s.textMuted,margin:"4px 0 0 0"},children:["Gestisci le sessioni attive (",a.length,")"]})]})]}),p?e.jsxs(l.div,{style:{...f,padding:"40px"},initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{style:y}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[e.jsx(j,{size:32,style:{color:i.accent,animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{color:s.textMuted,fontSize:"14px"},children:"Caricamento sessioni..."})]})]}):a.length===0?e.jsxs(l.div,{style:{...f,padding:"40px"},initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{style:y}),e.jsx("p",{style:{color:s.textMuted,fontSize:"14px",textAlign:"center"},children:"Nessuna sessione attiva trovata."})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[a.map((t,n)=>{const m=$(t.device),o=w===t.id;return e.jsxs(l.div,{style:{...f,padding:"16px"},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:n*.05},children:[e.jsx("div",{style:y}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[e.jsx("div",{style:{padding:"12px",borderRadius:"14px",background:t.isCurrent?`${i.success}20`:`${i.accent}15`,flexShrink:0},children:e.jsx(m,{size:24,style:{color:t.isCurrent?i.success:i.accent}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[e.jsx("h3",{style:{fontSize:"15px",fontWeight:600,color:s.textPrimary,margin:0},children:t.device}),t.isCurrent&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 8px",fontSize:"10px",fontWeight:600,color:i.success,background:`${i.success}15`,borderRadius:"6px"},children:[e.jsx(I,{size:10}),"QUESTO"]})]}),e.jsx("p",{style:{fontSize:"12px",color:s.textSecondary,margin:"4px 0 0 0"},children:t.browser}),e.jsxs("p",{style:{fontSize:"11px",color:s.textMuted,margin:"2px 0 0 0"},children:["Ultimo accesso: ",N(t.lastActive)]})]}),!t.isCurrent&&e.jsx(l.button,{onClick:()=>z(t.id),disabled:o,style:{padding:"10px",borderRadius:"10px",background:`${i.danger}15`,border:`1px solid ${i.danger}30`,color:i.danger,cursor:o?"not-allowed":"pointer",opacity:o?.5:1,flexShrink:0},whileTap:o?void 0:{scale:.95},children:o?e.jsx(j,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(M,{size:18})})]})]},t.id)}),D.length>0&&e.jsxs(l.button,{onClick:L,disabled:g,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 20px",borderRadius:"14px",background:`${i.danger}15`,border:`1px solid ${i.danger}30`,color:i.danger,cursor:g?"not-allowed":"pointer",opacity:g?.6:1,fontSize:"14px",fontWeight:600,marginTop:"8px"},whileTap:g?void 0:{scale:.98},initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[g?e.jsx(j,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(T,{size:18}),"Disconnetti tutte le altre sessioni"]})]}),e.jsxs(l.div,{style:{...f,padding:"16px",background:`${i.accent}08`},initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsx("div",{style:y}),e.jsx("p",{style:{fontSize:"13px",color:s.textSecondary,margin:0,lineHeight:1.5},children:"Qui puoi vedere tutti i dispositivi connessi al tuo account. Se noti attivit√† sospette, disconnetti la sessione e cambia subito la password."})]})]}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})};export{K as DispositiviConnessi};
